<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SpiderX API Docs</title>

<style>
body {
  background:#0b0f1a;
  color:#fff;
  font-family: Arial;
}

.box {
  width:90%;
  max-width:400px;
  margin:40px auto;
  background:#12182a;
  padding:20px;
  border-radius:12px;
}

input {
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:6px;
  border:none;
}

button {
  width:100%;
  padding:12px;
  background:#ff2e63;
  border:none;
  border-radius:6px;
  color:white;
  font-size:16px;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="box">
  <h2>Login</h2>

  <!-- ⚠️ مفيش action -->
  <form id="loginForm">
    <input id="username" placeholder="Username" />
    <input id="password" type="password" placeholder="Password" />
    <button type="submit">Login</button>
  </form>

  <p id="msg"></p>
</div>

<script>
console.log("JS Loaded ✅");

document.getElementById("loginForm").addEventListener("submit", async function(e){
  e.preventDefault();
  console.log("Login clicked");

  const username = document.getElementById("username").value;
  const password = document.getElementById("password").value;

  const res = await fetch("/api/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ username, password })
  });

  const data = await res.json();
  console.log(data);

  if (!res.ok) {
    document.getElementById("msg").innerText = data.error;
    return;
  }

  localStorage.setItem("token", data.token);
  localStorage.setItem("apiKey", data.apiKey);

  window.location.href = "/dashboard.html";
});
</script>

</body>
</html>
