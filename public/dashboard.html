<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SpiderX Dashboard</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: radial-gradient(circle at top, #0f172a, #020617);
  color: white;
}

.container {
  max-width: 1000px;
  margin: 60px auto;
  padding: 30px;
}

h1 {
  font-size: 46px;
  letter-spacing: 1px;
  filter: drop-shadow(0 0 18px rgba(255,46,99,0.25));
}

.card {
  background: rgba(255,255,255,0.04);
  border-radius: 18px;
  padding: 25px;
  box-shadow: 0 0 40px rgba(255,46,99,0.18);
  margin-top: 30px;
}

.label {
  opacity: 0.7;
  margin-top: 15px;
}

.box {
  background: #020617;
  padding: 12px;
  border-radius: 10px;
  margin-top: 6px;
  font-family: monospace;
}

button {
  margin-top: 25px;
  background: linear-gradient(135deg, #ff2e63, #ff5f9e);
  border: none;
  padding: 12px 30px;
  border-radius: 10px;
  color: white;
  font-size: 16px;
  cursor: pointer;
}

button:hover {
  box-shadow: 0 0 25px rgba(255,46,99,0.4);
}

ul {
  margin-top: 15px;
  padding-left: 20px;
}

li {
  opacity: 0.85;
  margin-bottom: 6px;
}
</style>
</head>

<body>
<div class="container">
  <h1>ðŸ•· SpiderX Dashboard</h1>

  <div class="card">
    <div class="label">Username</div>
    <div id="username" class="box">Loading...</div>

    <div class="label">API Key</div>
    <div id="apiKey" class="box">Loading...</div>

    <div class="label">Plan</div>
    <div id="plan" class="box">Loading...</div>

    <div class="label">Requests Used</div>
    <div id="requests" class="box">Loading...</div>

    <div class="label">Recent Requests</div>
    <ul id="logs"></ul>

    <button onclick="logout()">Logout</button>
  </div>
</div>

<script>
const apiKey = localStorage.getItem("apiKey");

if (!apiKey) {
  location.href = "/";
}

fetch("/api/me", {
  headers: {
    "Authorization": apiKey
  }
})
.then(res => res.json())
.then(data => {
  if (data.error) {
    alert("Session expired");
    logout();
    return;
  }

  document.getElementById("username").textContent = data.username;
  document.getElementById("apiKey").textContent = data.apiKey;
  document.getElementById("plan").textContent = data.plan;
  document.getElementById("requests").textContent = data.requests;

  const logs = document.getElementById("logs");
  logs.innerHTML = "";

  data.logs.forEach(l => {
    const li = document.createElement("li");
    li.textContent = `${l.endpoint} â€” ${l.createdAt}`;
    logs.appendChild(li);
  });
});

function logout() {
  localStorage.removeItem("apiKey");
  location.href = "/";
}
</script>
</body>
</html>
